<!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  Copyright (c) 2016-2018 Qualcomm Technologies, Inc.
  All Rights Reserved.
  Confidential and Proprietary - Qualcomm Technologies, Inc.
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
-->
<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"></meta>
<meta http-equiv="X-UA-Compatible" content="IE=9"></meta>
<title>Snapdragon Neural Processing Engine SDK: DSP Runtime Environment</title>
<link href="tabs.css" rel="stylesheet" type="text/css"></link>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="autoEnterCurrentDate.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="is.css" rel="stylesheet" type="text/css" ></link>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Snapdragon Neural Processing Engine SDK
   <span id="projectnumber"></span></div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dsp_runtime.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DSP Runtime Environment </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="dsp_runtime_lib_path"></a>
ADSP_LIBRARY_PATH Environment - for both ADSP and CDSP</h1>
<p>The DSP runtime is a dynamically loaded module, needed for using the AIP and DSP runtimes. This module is found in :</p><ul>
<li>$SNPE_ROOT/lib/dsp/libsnpe_dsp_skel.so (for SDM 820)</li>
<li>$SNPE_ROOT/lib/dsp/libsnpe_dsp_domains_skel.so (for v60 targets, excluding SDM 820)</li>
<li>$SNPE_ROOT/lib/dsp/libsnpe_dsp_v65_domains_v2_skel (for v65 targets)</li>
<li>$SNPE_ROOT/lib/dsp/libsnpe_dsp_v66_domains_v2_skel (for v66 targets)</li>
</ul>
<p>This module runs on the ADSP or the CDSP, depending on the target. Please refer to the Snapdragon Device Support Matrix table in the Overview section to determine SNPE support of DSP on various Snapdragon devices. SNPE automatically detects the appropriate DSP.</p>
<p>The DSP loader requires the environment variable ADSP_LIBRARY_PATH to be set to the directory where the shared libraries are stored. This environment variable is used for both ADSP and CDSP.</p>
<h1><a class="anchor" id="dsp_runtime_lib_commandline"></a>
For command line executables</h1>
<p>A typical setting of <b>ADSP_LIBRARY_PATH</b> looks like:</p>
<pre class="fragment">export ADSP_LIBRARY_PATH="&lt;path_to_dsp_skel&gt;;/system/lib/rfsa/adsp;/system/vendor/lib/rfsa/adsp;/dsp"
</pre><p>Where <b>&lt;path_to_dsp_skel.so&gt;</b> is the path where $SNPE_ROOT/lib/dsp/libsnpe_dsp_skel.so and/or other skel files (libsnpe_dsp_*_skel.so) have been pushed. Do not include the file name of the skel in the path.</p>
<p><b>Example:</b></p>
<p>Assuming the appropriate dsp skel has been pushed to /data/local/tmp/snpeexample/dsp/lib, then the following command for setting ADSP_LIBRARY_PATH would be used.</p>
<pre class="fragment">export ADSP_LIBRARY_PATH="/data/local/tmp/snpeexample/dsp/lib;/system/lib/rfsa/adsp;/system/vendor/lib/rfsa/adsp;/dsp"
</pre><p><b>Key points to note when setting the ADSP_LIBRARY_PATH:</b></p>
<p>Unlike LD_LIBRARY_PATH the path must be contained within quotations. Additionally unlike LD_LIBRARY_PATH, the directory separator is a semi-colon, not a colon.</p>
<p>For Android and most embeded linux systems, the 3 paths below <b>MUST</b> be part of ADSP_LIBRARY_PATH. If any of these are missing the DSP runtime may fail. </p><ul>
<li>
/system/lib/rfsa/adsp </li>
<li>
/system/vendor/lib/rfsa/adsp </li>
<li>
/dsp </li>
</ul>
<p>For embeded linux automotive system, the following DSP paths are required. </p><ul>
<li>
/usr/lib/rfsa/adsp </li>
<li>
/dsp </li>
</ul>
<h1><a class="anchor" id="dsp_runtime_lib_androidapk"></a>
For Android APKs</h1>
<p>ADSP_LIBRARY_PATH must be set for Android APKs as well, and it cannot be done using an "export" command. It must be done within code running in the APK.</p>
<p>The SNPE Android Java APIs automatically sets the ADSP_LIBRARY_PATH. The supplied SNPE Java AAR library automatically sets up the DSP environment for your Android application.</p>
<p>Android applications that do not use the SNPE Java AAR must set the ADSP_LIBRARY_PATH explicitly in native code. An example is provided below.</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> SetAdspLibraryPath(std::string nativeLibPath) {</div><div class="line">    std::stringstream path;</div><div class="line">    path &lt;&lt; nativeLibPath &lt;&lt; <span class="stringliteral">&quot;;/system/lib/rfsa/adsp;/system/vendor/lib/rfsa/adsp;/dsp&quot;</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> setenv(<span class="stringliteral">&quot;ADSP_LIBRARY_PATH&quot;</span>, path.str().c_str(), 1 <span class="comment">/*override*/</span>) == 0;</div><div class="line">}</div></div><!-- fragment --><p>Assuming that the DSP loadable module ($SNPE_ROOT/lib/dsp/libsnpe_dsp_skel.so and/or $SNPE_ROOT/lib/dsp/libsnpe_dsp_domains_skel.so and/or libsnpe_dsp_v65_domains_v2_skel.so) is placed in the same location as libSNPE.so in the Android application, the "nativeLibPath" input passed to the above method should be the string returned by the the following Android API: </p><div class="fragment"><div class="line">application.getApplicationInfo().nativeLibraryDir</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  Copyright (c) 2016-2018 Qualcomm Technologies, Inc.
  All Rights Reserved.
  Confidential and Proprietary - Qualcomm Technologies, Inc.
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 -->
<!-- start footer part -->
<div id="nav-path" class="navpath" font-size:small;><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <p align="right">
        80-NL315-14 A <br>
        MAY CONTAIN U.S. AND INTERNATIONAL EXPORT CONTROLLED INFORMATION
        <!--If the Controlled Distribution statement is to be included, uncomment below:-->
        <!--<b>Controlled Distribution - DO NOT COPY</b>-->
        <img class="footer" width:5%; alt="QTI Logo" src="images/QTI_Logo.png" />
      </p>
    </li>
  </ul>
</div>
</body>
</html>
